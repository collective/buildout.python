[buildout]
extends = base.cfg
parts = ${buildout:pypy3-parts}
pypy3-parts =
    pypy3

[pypy3-download:default]
recipe = hexagonit.recipe.download
strip-top-level-dir = true

[pypy3-download:linux2]
<= pypy3-download:default
url = https://downloads.python.org/pypy/pypy3.6-v7.3.1-linux64.tar.bz2
md5sum = 42547ff832ef049231683e99da4102d6

[pypy3-download:darwin]
<= pypy3-download:default
url = https://downloads.python.org/pypy/pypy3.6-v7.3.1-osx64.tar.bz2
md5sum = c944639521ca3b5e86ad79295a27ab40

[pypy3-download:darwin-leopard]
<= pypy3-download:darwin
url =
md5sum =

[pypy3-download:darwin-snowleopard]
<= pypy3-download:darwin
url =
md5sum =

[pypy3-download:darwin-highsierra]
<= pypy3-download:darwin
url = https://bitbucket.org/pypy/pypy/downloads/pypy3.6-v7.1.1-osx64.tar.bz2
md5sum = 9b5333801090b6993d0a7b77e7d3df8e

[pypy3-download:darwin-mojave]
<= pypy3-download:darwin-highsierra

[pypy3-download:darwin-catalina]
<= pypy3-download:darwin-mojave

[pypy3-virtualenv]
recipe = collective.recipe.template
input = ${buildout:python-buildout-root}/templates/virtualenv.in
output = ${buildout:bin-directory}/virtualenv-pypy3
virtualenv = ${virtualenv:location}/virtualenv.py
executable = ${pypy3-download:location}/bin/pypy3

[pypy3]
recipe = plone.recipe.command
location = ${buildout:directory}/pypy3
command =
    ${pypy3-virtualenv:output} --system-site-packages ${:location}
update-command = ${:command}
stop-on-error = yes
